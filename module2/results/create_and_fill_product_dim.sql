drop table if exists dwh.product_dim;

CREATE TABLE dwh.product_dim
(
	 product_key  int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	 product_id   varchar(15) NOT NULL,
	 category     varchar NOT NULL,
	 sub_category varchar NOT NULL,
	 product_name varchar NOT NULL
);

insert into dwh.product_dim (product_id, category, sub_category, product_name)
select distinct
	o.product_id  product_id,
	o.category  category,
	o.subcategory subcategory,
	o.product_name product_name
from stg.orders o;

select 
	*
from dwh.product_dim;