drop table if exists dwh.location_dim;

CREATE TABLE dwh.location_dim
(
	 location_key  int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	 country   varchar(15) NOT NULL,
	 city     varchar NOT NULL,
	 state varchar NOT NULL,
	 postal_code varchar,
	 region varchar NOT NULL
);

insert into dwh.location_dim (country, city, state, postal_code, region)
select distinct
	o.country country,
	o.city city,
	o.state state,
	o.postal_code postal_code,
	o.region region
from stg.orders o;

UPDATE dwh.location_dim
SET postal_code='05401'
WHERE city='Burlington' and country='United States' 
	and state='Vermont' and postal_code is null;

select 
	*
from dwh.location_dim;