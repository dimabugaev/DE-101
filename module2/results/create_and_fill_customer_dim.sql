drop table if exists dwh.customer_dim;

CREATE TABLE dwh.customer_dim
(
	 customer_key  int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	 customer_id   varchar(15) NOT NULL,
	 customer_name varchar(50) NOT NULL,
	 segment       varchar(50) NOT NULL
);

insert into dwh.customer_dim (customer_id, customer_name, segment)
select distinct
	o.customer_id customer_id,
	o.customer_name customer_name,
	o.segment segment 
from public.orders o;

select 
	*
from dwh.customer_dim